{%- assign posts = paginator.posts | default: site.posts -%}

{%- for post in posts -%}
  {%- comment -%}
    Normalize image object:
    post.image can be:
    - string: /assets/gear.png
    - object: { path: /assets/..., alt: ... }
  {%- endcomment -%}
  {%- assign has_image = false -%}
  {%- if post.image %}
    {%- if post.image.path %}
      {%- assign img_src = post.image.path -%}
      {%- assign img_alt = post.image.alt | default: post.title -%}
      {%- assign has_image = true -%}
    {%- else %}
      {%- assign img_src = post.image -%}
      {%- assign img_alt = post.title -%}
      {%- assign has_image = true -%}
    {%- endif -%}
  {%- endif -%}

  <article class="post-card-horizontal">
    {%- if has_image -%}
    <div class="post-card-thumb">
      <a href="{{ post.url | relative_url }}">
        <img src="{{ img_src | relative_url }}" alt="{{ img_alt | escape }}">
      </a>
    </div>
    {%- endif -%}

    <div class="post-card-body">
      <h2 class="post-card-title">
        <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
      </h2>

      {%- if post.description -%}
        <p class="post-card-excerpt">{{ post.description }}</p>
      {%- else -%}
        <p class="post-card-excerpt">
          {{ post.excerpt | strip_html | truncate: 140 }}
        </p>
      {%- endif -%}

      <div class="post-card-meta">
        <span class="post-card-meta-item">
          <i class="far fa-calendar"></i>
          {{ post.date | date: "%b %-d, %Y" }}
        </span>
        {%- if post.categories and post.categories != empty -%}
        <span class="post-card-meta-item">
          <i class="far fa-folder-open"></i>
          {{ post.categories | join: ", " }}
        </span>
        {%- endif -%}
      </div>
    </div>
  </article>
{%- endfor -%}
